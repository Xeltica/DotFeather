# Tilemap

Tilemap を使うと、テクスチャから生成したタイルを格子状に並べて描画できます。
他の手段でもテクスチャを格子状に描画できますが、タイルマップは最適化されているため、ふつうはこれを使用するべきです。

## タイル

タイルは、Tilemapにおける描画の最小単位です。タイルは `ITile` インターフェイスを実装したクラスで表現します。現在は `Tile` クラスというテクスチャから作成するタイルが組み込まれていますが、独自に `ITile` インターフェイスを実装したタイルを自作することで、複雑なレンダリングを実現できます。

Tile クラスを読み込んでタイルマップに貼り付ける方法を次に示します。

```cs
// マップを作る
var map = new Tilemap((16, 16));
// テクスチャを読み込む
var texture = Texture2D.LoadFrom("./grass.png");
// タイルを生成する
var tile = new Tile(texture);

// 2, 4 の位置にタイルを配置する
map[2, 4] = tile;

// (1, 4) から (8, 8) へ直線を描画する
map.Line(1, 4, 8, 8, tile);

// (2, 16) にサイズ (16, 16) の矩形を描画する
map.Rect(2, 16, 16, 16, tile);
```

また、ファイル名を指定して直接タイルを生成することも出来ます。

```cs
Tile sprite = Tile.LoadFrom("./assets/castle.png");
```

## レンダリングモード

タイルマップは、状況に応じて2種類のレンダリングモードを使い分けます。

### RenderAll モード

RenderAll モードでは、タイルマップに貼り付けられた全てのタイルのうち、画面内に存在するものを描画します。

### Scan モード

Scan モードでは、画面を左上から右下まで走査しながら描画すべきタイルを見つけ、描画します。

### Auto モード

Auto モードでは、上記の2つのモードを次の条件で動的に切り替えます。
- 画面に存在しうるタイル数　＞　実際のタイル数
	- RenderAllモード
- そうでない
	- Scanモード

**このモードがデフォルトです。**

### モードを切り替える

通常はAutoモードの使用をおすすめしますが、片方のモードで問題が発生する場合などは切り替えることで改善する可能性があります。

```cs
map.Renderingmode = TilemapRenderingMode.RenderAll;
```

また、Autoモードで使用される実際のレンダリングモードは、`PreferredRenderingMode` プロパティを介して取得できます。
