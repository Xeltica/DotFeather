version: 2.2.0.{build}
image: Visual Studio 2019
skip_non_tags: true

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: "{version}"
  package_version: "{version}"
  assembly_version: "{version}"
  file_version: "{version}"
  informational_version: "{version}"

before_build:
  - ps: >-
      nuget restore

build:
  project: C:\projects\dotfeather\dotfeather\dotfeather.csproj
  publish_nuget: true

configuration: Release

after_build:
  - nuget pack -Prop Configuration=Release DotFeather -OutputDirectory DotFeather/bin/Release/

artifacts:
  - path: '**\*.nupkg'
    name: DotFeather

deploy:
  - provider: NuGet
    api_key:
      # Use encrypt tool
      # https://ci.appveyor.com/tools/encrypt
      secure: nknIyuf45/JACWB2OAWD32oU6HlW4AkkiI974KwKPPkMh3dRHJXsVQVbN/iIUjg/
    artifact: /.*\.nupkg/
    on:
      appveyor_repo_tag: true
  - provider: GitHub
    artifact: /.*\.nupkg/ # upload all NuGet packages to release assets
    draft: false
    prerelease: false
    description: |
      ## 2.2.0

      ### 新機能
      - `ISizedDrawable` インターフェイスを追加。幅および高さを持つ全てのオブジェクトはこのインターフェイスを実装します
      - `IContainable` インターフェイスを追加。このインターフェイスを実装する描画可能オブジェクトをコンテナーに追加することで、子から親オブジェクトを取得したり、子の絶対座標を取得できます

      ### 仕様変更
      - いくつかのビルトイン描画可能オブジェクトが、新たに追加されたインターフェイスを実装しました
      - いくつかの描画可能オブジェクトの `Destroy()` メソッドをオーバーライドできるようになりました

      ----

      ### New features
      - Added `ISizedDrawable` interface. All objects with width and height implement this interface
      - Added `IContainable` interface. You can get the parent object from the child or get the absolute coordinates of the child by adding a drawable that implements this interface to the container

      ## Changes
       - Some built-in drawables have implemented newly added interfaces
       - You can now override the `Destroy()` method of some drawable objects

    auth_token:
      secure: FUlGF4CyRZNM6jaGz2wlmsOIwZt4av2Cxn4lHbi5wU5lim3FixH9ZIhLGDRZftOx
    on:
      APPVEYOR_REPO_TAG: true # deploy on tag push only
